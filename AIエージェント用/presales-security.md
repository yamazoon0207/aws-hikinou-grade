# セキュリティ要件ヒアリング

## 質問項目

### 1. データ保護
- **質問**: 「扱うデータの機密性レベルは？」
  - 個人情報（PII）
  - クレジットカード情報（PCI DSS）
  - 医療情報（HIPAA）
  - 機密ビジネスデータ

- **質問**: 「データの暗号化要件は？」
  - 保管時の暗号化（at rest）
  - 転送時の暗号化（in transit）
  - 暗号化キーの管理方法

### 2. アクセス制御
- **質問**: 「ユーザー認証方式は？」
  - ID/パスワード
  - 多要素認証（MFA）
  - SSO（シングルサインオン）
  - SAML、OAuth、OpenID Connect

- **質問**: 「アクセス権限の管理方法は？」
  - ロールベースアクセス制御（RBAC）
  - 属性ベースアクセス制御（ABAC）
  - 最小権限の原則

### 3. ネットワークセキュリティ
- **質問**: 「ネットワーク分離の要件は？」
  - パブリック/プライベートサブネット
  - VPN接続
  - Direct Connect
  - PrivateLink

- **質問**: 「外部からのアクセス制御は？」
  - IP制限
  - WAF（Web Application Firewall）
  - DDoS対策

### 4. 監査・ログ
- **質問**: 「監査ログの保持期間は？」
  - 法的要件（1年、3年、7年など）
  - アクセスログ、変更ログ、エラーログ

- **質問**: 「セキュリティイベントの検知要件は？」
  - リアルタイム検知
  - 異常検知
  - インシデント対応

### 5. コンプライアンス
- **質問**: 「準拠すべき規制・基準は？」
  - ISO 27001
  - SOC 2
  - GDPR
  - 個人情報保護法
  - 業界固有の規制

## AWSサービスマッピング

### ID・アクセス管理
- **IAM**: ユーザー、ロール、ポリシー管理
- **Cognito**: ユーザー認証、フェデレーション
- **IAM Identity Center**: SSO、マルチアカウント管理
- **Secrets Manager**: 認証情報の安全な保管

### データ保護
- **KMS**: 暗号化キー管理
- **CloudHSM**: ハードウェアセキュリティモジュール
- **S3**: バケット暗号化、バージョニング
- **RDS**: 暗号化、SSL/TLS接続

### ネットワークセキュリティ
- **VPC**: セキュリティグループ、NACL
- **WAF**: Webアプリケーション保護
- **Shield**: DDoS保護
- **Network Firewall**: ステートフルファイアウォール
- **PrivateLink**: プライベート接続

### 監視・検知
- **CloudTrail**: API監査ログ
- **CloudWatch**: ログ集約、メトリクス監視
- **GuardDuty**: 脅威検知
- **Security Hub**: セキュリティ状態の一元管理
- **Config**: リソース設定の監査

### コンプライアンス
- **Artifact**: コンプライアンスレポート
- **Audit Manager**: 監査証跡の自動収集
- **Macie**: 機密データの検出と保護

## チェックリスト

- [ ] データ分類と機密性レベルの確認
- [ ] 暗号化要件の確認
- [ ] 認証・認可方式の決定
- [ ] ネットワーク分離要件の確認
- [ ] ログ保持期間の確認
- [ ] コンプライアンス要件の確認
- [ ] インシデント対応プロセスの確認
- [ ] 脆弱性管理プロセスの確認

## ナレッジ（随時追加）

### 事例・ベストプラクティス
<!-- ここに案件で得た知見を追加してください -->

### セキュリティチェックリスト
<!-- 実案件で使用したチェックリストを追加 -->



---

## 実案件ナレッジ

### 情報セキュリティコンプライアンス
- 順守すべき組織規程、ルール、法令、ガイドラインの確認
- 関連ドキュメントへのリンク管理

### セキュリティリスク分析
**分析範囲の方針:**
- ネットワークを通じた不特定多数の攻撃者からの脅威にさらされるか
- 重要情報が取り扱われているか
- 脅威範囲の定期的な見直し時期の設定

### ネットワーク診断

**目視による設定確認:**
- Security Group設定の目視確認
- Trusted Advisorによる確認

**ペネトレーションテスト:**
- 疑似攻撃による脆弱性診断の実施有無
- 参考: [AWSでの侵入テストポリシー](https://aws.amazon.com/jp/security/penetration-testing/)

**脆弱性調査:**
- ネットワーク上のサーバや通信機能をもつソフトウェアの脆弱性調査
- Amazon Inspectorの利用検討

### セキュリティパッチ適用ポリシー

**適用対象:**
- OS、ミドルウェア、データベース

**適用時期:**
- 毎月、毎週など

**自動適用:**
- Systems Manager Patch Managerの利用
- 適用後の確認タイミング

### データ暗号化の詳細

**伝送データ暗号化:**
- インターネット通信（インバウンド・アウトバウンド）は基本的に暗号化
- ELB/CloudFront利用時はACM証明書（無料）を活用
- その他は購入したTLS証明書または自己証明書を適用
- 暗号化スイート: TLS 1.2以上を推奨（2020年4月時点）

**蓄積データ暗号化:**
- EBS、EFS、RDSストレージの暗号化
- S3バケットの暗号化

**鍵管理:**
- KMSによる管理（推奨）
- ユーザー管理の鍵

### ログ取得・保管の詳細

**監視対象ログ:**
- OS・ミドルウェアログ（CloudWatch Logs / DataDog等）
- CloudTrail（AWS API監査）
- AWS Config（リソース設定変更）
- VPCフローログ（ネットワークトラフィック）

**保管期間:**
- 法的要件に応じた設定
- コンプライアンス要件の確認

### ネットワーク制御の詳細方針

**基本方針:**
- ファイアウォールは「セキュリティグループ」を使用
- NACLやOSファイアウォールは二重管理となるため使用しない
- 参考: [VPCのセキュリティグループ](https://docs.aws.amazon.com/ja_jp/vpc/latest/userguide/VPC_SecurityGroups.html)

**インターネット通信の制御:**
- inboundとoutboundを制御
- outbound制御の理由: 組織外リソースへの不要なアクセスを予め制限
- 許可するプロトコル、ポート番号を指定
- 許可するCIDRは必要最小限（/32推奨）
- システム特性上必要な場合のみ0.0.0.0/0を許可
- 拒否設定は管理負荷を考慮し行わない

**VPC内部通信の制御:**
- inboundのみ制御
- 許可するプロトコル、ポート番号を指定
- 許可するCIDRは必要最小限の範囲
- 拒否設定は管理負荷を考慮し行わない

**制御比較表:**

| 項目 | インターネット通信 | VPC内部通信 |
|------|-------------------|-------------|
| 制御方向 | inbound + outbound | inbound |
| 制御方法 | 許可 | 許可 |
| CIDR | 必要最小限（/32推奨） | 必要最小限 |
| プロトコル | 必要最小限を指定 | 必要最小限を指定 |
| ポート番号 | 必要最小限を指定 | 必要最小限を指定 |

### マルウェア対策
- Deep Security As A Service等のエンドポイント保護
- Amazon GuardDutyによる脅威検知
- 定期的なスキャン実施

### DDoS対策

**AWS標準保護:**
- レイヤー3/4のDDoS攻撃への自動対処
- 参考: [DDoS攻撃への対応](https://docs.aws.amazon.com/ja_jp/waf/latest/developerguide/ddos-responding.html)
- 注意: 全てのレイヤー3/4攻撃を防げるとは限らない

**ベストプラクティス:**
- 参考: [AWS Best Practices for DDoS Resiliency](https://d1.awsstatic.com/whitepapers/Security/DDoS_White_Paper.pdf)

**事前対策:**
1. CloudFrontなどのCDNでコンテンツをキャッシュ
2. WebサーバはELB + Auto Scalingでトラフィック増加に対応
3. AWS Shield Standard（無料、自動有効）
4. AWS Shield Advanced（有料、高度な保護）の検討
5. WAFによるアプリケーション層の保護

### セキュリティ設計チェックリスト

- [ ] 情報セキュリティコンプライアンスの確認
- [ ] セキュリティリスク分析範囲の決定
- [ ] ネットワーク診断計画（目視/ペネトレ/脆弱性）
- [ ] パッチ適用ポリシーの策定
- [ ] 伝送データ暗号化の設定
- [ ] 蓄積データ暗号化の設定
- [ ] 鍵管理方法の決定
- [ ] ログ取得・保管設定
- [ ] セキュリティグループ設計
- [ ] マルウェア対策の実装
- [ ] DDoS対策の実装
